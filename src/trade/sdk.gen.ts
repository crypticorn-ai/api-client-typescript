import {
  createClient as createNativeClient,
  createConfig,
  type OptionsLegacyParser,
} from "@hey-api/client-fetch";

import type {
  GetBotOrdersCountData,
  GetBotOrdersCountError,
  GetBotOrdersCountResponse,
  GetBotPnlData,
  GetBotPnlError,
  GetBotPnlResponse,
  GetBotOrdersData,
  GetBotOrdersError,
  GetBotOrdersResponse,
  GetBotActionsData,
  GetBotActionsError,
  GetBotActionsResponse,
  GetBotsData,
  GetBotsError,
  GetBotsResponse,
  CreateBotData,
  CreateBotError,
  CreateBotResponse,
  GetBotData,
  GetBotError,
  GetBotResponse,
  UpdateBotData,
  UpdateBotError,
  UpdateBotResponse,
  GetExchangeKeysData,
  GetExchangeKeysError,
  GetExchangeKeysResponse,
  CreateExchangeKeyData,
  CreateExchangeKeyError,
  CreateExchangeKeyResponse,
  UpdateExchangeKeyData,
  UpdateExchangeKeyError,
  UpdateExchangeKeyResponse,
  DeleteExchangeKeyData,
  DeleteExchangeKeyError,
  DeleteExchangeKeyResponse,
  GetExchangeKeyBalancesError,
  GetExchangeKeyBalancesResponse,
  PostFuturesActionData,
  PostFuturesActionError,
  PostFuturesActionResponse,
  PostSpotActionData,
  PostSpotActionError,
  PostSpotActionResponse,
  GetStrategiesError,
  GetStrategiesResponse,
  CreateStrategyData,
  CreateStrategyError,
  CreateStrategyResponse,
  UpdateStrategyData,
  UpdateStrategyError,
  UpdateStrategyResponse,
  PingError,
  PingResponse,
  GetMetricsError,
  GetMetricsResponse,
} from "./types.gen";

export function createClient(
  baseUrl: string,
  headers: any,
  fetch = globalThis.fetch,
) {
  const client = createNativeClient(
    createConfig({
      baseUrl,
      fetch,
      headers,
    }),
  );

  // This file is auto-generated by @hey-api/openapi-ts

  /**
   * Get Bot Orders Count
   * Get the number of orders for a bot by day, week, month, or year. The default sort is `timestamp` and the default order is `asc`.
   */
  const getBotOrdersCount = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetBotOrdersCountData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotOrdersCountResponse,
      GetBotOrdersCountError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}/orders/count",
    });
  };

  /**
   * Get Bot Pnl
   * Returns a list of PnLs for a bot over time, sorted by `timestamp` ascending by default.
   *
   * If more than 1000 data points exist, PnLs are grouped by day.
   *
   * For relative type, uses TWR-style cumulative percentage returns.
   * For absolute type, uses traditional cumulative PnL calculation.
   */
  const getBotPnl = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetBotPnlData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotPnlResponse,
      GetBotPnlError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}/orders/pnl",
    });
  };

  /**
   * Get Bot Orders
   * Get all orders for a bot. Default sort is `created_at` and default order is `desc`.
   */
  const getBotOrders = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetBotOrdersData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotOrdersResponse,
      GetBotOrdersError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}/orders",
    });
  };

  /**
   * Get Bot Actions
   * Get all orders for a bot
   */
  const getBotActions = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetBotActionsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotActionsResponse,
      GetBotActionsError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}/actions",
    });
  };

  /**
   * Get Bots
   * Returns all bots. Default sort is by created_at, descending. Deleted bots are included by default.
   */
  const getBots = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetBotsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotsResponse,
      GetBotsError,
      ThrowOnError
    >({
      ...options,
      url: "/bots",
    });
  };

  /**
   * Create Bot
   * Creates a new bot.
   */
  const createBot = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateBotData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateBotResponse,
      CreateBotError,
      ThrowOnError
    >({
      ...options,
      url: "/bots",
    });
  };

  /**
   * Get Bot
   * Returns a bot.
   */
  const getBot = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetBotData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBotResponse,
      GetBotError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}",
    });
  };

  /**
   * Update Bot
   * Updates a bot.
   */
  const updateBot = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<UpdateBotData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).put<
      UpdateBotResponse,
      UpdateBotError,
      ThrowOnError
    >({
      ...options,
      url: "/bots/{id}",
    });
  };

  /**
   * Get Exchange Keys
   * Get all exchange keys. Returns all non-deleted API keys by default.
   */
  const getExchangeKeys = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetExchangeKeysData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetExchangeKeysResponse,
      GetExchangeKeysError,
      ThrowOnError
    >({
      ...options,
      url: "/api-keys",
    });
  };

  /**
   * Post Exchange Key
   * Create a new exchange key.
   */
  const createExchangeKey = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateExchangeKeyData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateExchangeKeyResponse,
      CreateExchangeKeyError,
      ThrowOnError
    >({
      ...options,
      url: "/api-keys",
    });
  };

  /**
   * Put Exchange Key
   * Update an exchange key.
   */
  const updateExchangeKey = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<UpdateExchangeKeyData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).put<
      UpdateExchangeKeyResponse,
      UpdateExchangeKeyError,
      ThrowOnError
    >({
      ...options,
      url: "/api-keys/{id}",
    });
  };

  /**
   * Delete Exchange Key
   * Delete an exchange key.
   */
  const deleteExchangeKey = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<DeleteExchangeKeyData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).delete<
      DeleteExchangeKeyResponse,
      DeleteExchangeKeyError,
      ThrowOnError
    >({
      ...options,
      url: "/api-keys/{id}",
    });
  };

  /**
   * Get Exchange Key Balances
   * Get the balances of all exchange keys.
   */
  const getExchangeKeyBalances = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetExchangeKeyBalancesResponse,
      GetExchangeKeyBalancesError,
      ThrowOnError
    >({
      ...options,
      url: "/api-keys/balances",
    });
  };

  /**
   * Post Futures Action
   * Endpoint to send futures trading actions. The action is queued for processing and the response is returned immediately. Only API key authentication is supported.
   */
  const postFuturesAction = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<PostFuturesActionData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      PostFuturesActionResponse,
      PostFuturesActionError,
      ThrowOnError
    >({
      ...options,
      url: "/actions/futures",
    });
  };

  /**
   * Post Spot Action
   */
  const postSpotAction = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<PostSpotActionData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      PostSpotActionResponse,
      PostSpotActionError,
      ThrowOnError
    >({
      ...options,
      url: "/actions/spot",
    });
  };

  /**
   * Get Strategies
   * Get all strategies.
   */
  const getStrategies = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetStrategiesResponse,
      GetStrategiesError,
      ThrowOnError
    >({
      ...options,
      url: "/strategies",
    });
  };

  /**
   * Create Strategy
   * Creates a new strategy.
   */
  const createStrategy = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateStrategyData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateStrategyResponse,
      CreateStrategyError,
      ThrowOnError
    >({
      ...options,
      url: "/strategies",
    });
  };

  /**
   * Update Strategy
   * Updates a strategy. If the strategy is being disabled, all bots associated with it will be set to stopping.
   */
  const updateStrategy = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<UpdateStrategyData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).put<
      UpdateStrategyResponse,
      UpdateStrategyError,
      ThrowOnError
    >({
      ...options,
      url: "/strategies/{id}",
    });
  };

  /**
   * Ping
   * Returns 'OK' if the API is running.
   */
  const ping = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      PingResponse,
      PingError,
      ThrowOnError
    >({
      ...options,
      url: "/",
    });
  };

  /**
   * Metrics
   * Get Prometheus metrics for the application. Returns plain text.
   */
  const getMetrics = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetMetricsResponse,
      GetMetricsError,
      ThrowOnError
    >({
      ...options,
      url: "/metrics",
    });
  };

  return {
    getBotOrdersCount,
    getBotPnl,
    getBotOrders,
    getBotActions,
    getBots,
    createBot,
    getBot,
    updateBot,
    getExchangeKeys,
    createExchangeKey,
    updateExchangeKey,
    deleteExchangeKey,
    getExchangeKeyBalances,
    postFuturesAction,
    postSpotAction,
    getStrategies,
    createStrategy,
    updateStrategy,
    ping,
    getMetrics,
  };
}
