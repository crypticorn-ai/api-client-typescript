import {
  createClient as createNativeClient,
  createConfig,
  type OptionsLegacyParser,
} from '@hey-api/client-fetch';

import type {
  PostPredictionData,
  PostPredictionError,
  PostPredictionResponse,
  PostPolymarketPredictionData,
  PostPolymarketPredictionError,
  PostPolymarketPredictionResponse,
  GetLatestPredictionsData,
  GetLatestPredictionsError,
  GetLatestPredictionsResponse,
  GetLatestPolymarketPredictionsError,
  GetLatestPolymarketPredictionsResponse,
  GetLatestPredictionData,
  GetLatestPredictionError,
  GetLatestPredictionResponse,
  GetEconomicNewsData,
  GetEconomicNewsError,
  GetEconomicNewsResponse,
  GetFearGreedData,
  GetFearGreedError,
  GetFearGreedResponse,
  PostPolymarketHistogramData,
  PostPolymarketHistogramError,
  PostPolymarketHistogramResponse,
  GetPolymarketHistogramsData,
  GetPolymarketHistogramsError,
  GetPolymarketHistogramsResponse,
  GetLatestPolymarketHistogramsError,
  GetLatestPolymarketHistogramsResponse,
  GetLatestPolymarketHistogramData,
  GetLatestPolymarketHistogramError,
  GetLatestPolymarketHistogramResponse,
  PingError,
  PingResponse,
  GetMetricsError,
  GetMetricsResponse,
} from './types.gen';

export function createClient(
  baseUrl: string,
  headers: any,
  fetch = globalThis.fetch,
) {
  const client = createNativeClient(
    createConfig({
      baseUrl,
      fetch,
      headers,
    }),
  );

  // This file is auto-generated by @hey-api/openapi-ts

  /**
   * Post Prediction
   * Post a new prediction. The prediction is processed in the background, and the response is immediately returned. Only API key authentication is supported.
   */
  const postPrediction = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<PostPredictionData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      PostPredictionResponse,
      PostPredictionError,
      ThrowOnError
    >({
      ...options,
      url: '/predictions',
    });
  };

  /**
   * Post Polymarket Prediction
   * Post a new Polymarket prediction.
   *
   * The prediction is stored in the background and a 202 response is returned.
   */
  const postPolymarketPrediction = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<PostPolymarketPredictionData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      PostPolymarketPredictionResponse,
      PostPolymarketPredictionError,
      ThrowOnError
    >({
      ...options,
      url: '/predictions/polymarket',
    });
  };

  /**
   * Get Latest Predictions
   * Get the latest predictions for a given version for all symbols. If no version is provided, the latest AI model version is used.
   */
  const getLatestPredictions = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetLatestPredictionsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetLatestPredictionsResponse,
      GetLatestPredictionsError,
      ThrowOnError
    >({
      ...options,
      url: '/predictions/latest',
    });
  };

  /**
   * Get Latest Polymarket Predictions
   * Get the latest Polymarket predictions for all symbols and intervals.
   *
   * The response contains one latest prediction per (symbol, interval) pair.
   */
  const getLatestPolymarketPredictions = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetLatestPolymarketPredictionsResponse,
      GetLatestPolymarketPredictionsError,
      ThrowOnError
    >({
      ...options,
      url: '/predictions/polymarket/latest',
    });
  };

  /**
   * Get Latest Prediction
   * Get the latest prediction for a given symbol and version. If no version is provided, the latest AI model version is used.
   */
  const getLatestPrediction = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetLatestPredictionData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetLatestPredictionResponse,
      GetLatestPredictionError,
      ThrowOnError
    >({
      ...options,
      url: '/predictions/latest/{symbol}',
    });
  };

  /**
   * Get Economic News
   * Get paginated Economic News data. Default sort is `timestamp` and default order is `desc`.
   */
  const getEconomicNews = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetEconomicNewsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetEconomicNewsResponse,
      GetEconomicNewsError,
      ThrowOnError
    >({
      ...options,
      url: '/news/economic',
    });
  };

  /**
   * Get Fear Greed
   * Get Fear & Greed Index data. Default sort is `timestamp` and default order is `desc`.
   */
  const getFearGreed = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetFearGreedData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetFearGreedResponse,
      GetFearGreedError,
      ThrowOnError
    >({
      ...options,
      url: '/sentiment/fng',
    });
  };

  /**
   * Post Polymarket Histogram
   * Post a new Polymarket histogram.
   *
   * The histogram is stored in the background and a 202 response is returned.
   * This endpoint is called by the histogram generation service to store
   * pattern-matching histogram data for price predictions.
   */
  const postPolymarketHistogram = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<PostPolymarketHistogramData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      PostPolymarketHistogramResponse,
      PostPolymarketHistogramError,
      ThrowOnError
    >({
      ...options,
      url: '/histogram',
    });
  };

  /**
   * Get Polymarket Histograms
   * Get Polymarket histograms with optional filtering.
   *
   * Returns histograms ordered by timestamp (newest first), optionally filtered
   * by symbol and/or interval.
   */
  const getPolymarketHistograms = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetPolymarketHistogramsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetPolymarketHistogramsResponse,
      GetPolymarketHistogramsError,
      ThrowOnError
    >({
      ...options,
      url: '/histogram',
    });
  };

  /**
   * Get Latest Polymarket Histograms
   * Get the latest Polymarket histograms for all symbols and intervals.
   *
   * The response contains one latest histogram per (symbol, interval) pair.
   */
  const getLatestPolymarketHistograms = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetLatestPolymarketHistogramsResponse,
      GetLatestPolymarketHistogramsError,
      ThrowOnError
    >({
      ...options,
      url: '/histogram/latest',
    });
  };

  /**
   * Get Latest Polymarket Histogram
   * Get the latest Polymarket histogram for a specific symbol and interval.
   *
   * Returns the most recent histogram data for pattern-matching based predictions.
   */
  const getLatestPolymarketHistogram = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<
      GetLatestPolymarketHistogramData,
      ThrowOnError
    >,
  ) => {
    return (options?.client ?? client).get<
      GetLatestPolymarketHistogramResponse,
      GetLatestPolymarketHistogramError,
      ThrowOnError
    >({
      ...options,
      url: '/histogram/latest/{symbol}/{interval}',
    });
  };

  /**
   * Ping
   * Returns 'OK' if the API is running.
   */
  const ping = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      PingResponse,
      PingError,
      ThrowOnError
    >({
      ...options,
      url: '/',
    });
  };

  /**
   * Metrics
   * Get Prometheus metrics for the application in multiprocess mode. Returns plain text.
   */
  const getMetrics = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetMetricsResponse,
      GetMetricsError,
      ThrowOnError
    >({
      ...options,
      url: '/metrics',
    });
  };

  return {
    postPrediction,
    postPolymarketPrediction,
    getLatestPredictions,
    getLatestPolymarketPredictions,
    getLatestPrediction,
    getEconomicNews,
    getFearGreed,
    postPolymarketHistogram,
    getPolymarketHistograms,
    getLatestPolymarketHistograms,
    getLatestPolymarketHistogram,
    ping,
    getMetrics,
  };
}
