import {
  createClient as createNativeClient,
  createConfig,
  type OptionsLegacyParser,
} from "@hey-api/client-fetch";

import type {
  GetProductsCaptchaAuthData,
  GetProductsCaptchaAuthError,
  GetProductsCaptchaAuthResponse,
  GetProductsData,
  GetProductsError,
  GetProductsResponse,
  CreateProductData,
  CreateProductError,
  CreateProductResponse,
  GetProductUsageError,
  GetProductUsageResponse,
  UpdateProductData,
  UpdateProductError,
  UpdateProductResponse,
  GetPaymentHistoryData,
  GetPaymentHistoryError,
  GetPaymentHistoryResponse,
  GetSubscriptionsData,
  GetSubscriptionsError,
  GetSubscriptionsResponse,
  GetPaymentsByInvoiceData,
  GetPaymentsByInvoiceError,
  GetPaymentsByInvoiceResponse,
  GetCouponByCodeCaptchaAuthData,
  GetCouponByCodeCaptchaAuthError,
  GetCouponByCodeCaptchaAuthResponse,
  GetCouponByCodeData,
  GetCouponByCodeError,
  GetCouponByCodeResponse,
  GetCouponsData,
  GetCouponsError,
  GetCouponsResponse,
  CreateCouponData,
  CreateCouponError,
  CreateCouponResponse,
  UpdateCouponData,
  UpdateCouponError,
  UpdateCouponResponse,
  DeactivateCouponData,
  DeactivateCouponError,
  DeactivateCouponResponse,
  GetNowApiStatusError,
  GetNowApiStatusResponse,
  HandleNowWebhookError,
  HandleNowWebhookResponse,
  CreateInvoiceData,
  CreateInvoiceError,
  CreateInvoiceResponse,
  GetInvoiceData,
  GetInvoiceError,
  GetInvoiceResponse,
  StripeWebhookStripeWebhookPostError,
  StripeWebhookStripeWebhookPostResponse,
  GetAicPriceData,
  GetAicPriceError,
  GetAicPriceResponse,
  GetBalancesData,
  GetBalancesError,
  GetBalancesResponse,
  GetScopesInfoData,
  GetScopesInfoError,
  GetScopesInfoResponse,
  GetThresholdsError,
  GetThresholdsResponse,
  PingError,
  PingResponse,
  GetMetricsError,
  GetMetricsResponse,
} from "./types.gen";

export function createClient(
  baseUrl: string,
  headers: any,
  fetch = globalThis.fetch,
) {
  const client = createNativeClient(
    createConfig({
      baseUrl,
      fetch,
      headers,
    }),
  );

  // This file is auto-generated by @hey-api/openapi-ts

  /**
   * Get Products Captcha Auth
   * Get all software products from Crypticorn. You can apply a coupon code to the products. If the coupon is not valid, the products will be returned without any discount.
   */
  const getProductsCaptchaAuth = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetProductsCaptchaAuthData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetProductsCaptchaAuthResponse,
      GetProductsCaptchaAuthError,
      ThrowOnError
    >({
      ...options,
      url: "/products/captcha",
    });
  };

  /**
   * Get Products
   * Get all software products from Crypticorn. You can apply a coupon code to the products. If the coupon is not valid, the products will be returned without any discount.
   */
  const getProducts = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetProductsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetProductsResponse,
      GetProductsError,
      ThrowOnError
    >({
      ...options,
      url: "/products",
    });
  };

  /**
   * Create Product
   * Create a new product
   */
  const createProduct = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateProductData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateProductResponse,
      CreateProductError,
      ThrowOnError
    >({
      ...options,
      url: "/products",
    });
  };

  /**
   * Get Product Usage
   * Get the usage count of each product. Returns a list of tuples (product_id, usage_count).
   */
  const getProductUsage = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetProductUsageResponse,
      GetProductUsageError,
      ThrowOnError
    >({
      ...options,
      url: "/products/usage",
    });
  };

  /**
   * Update Product
   * Update an existing product
   */
  const updateProduct = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<UpdateProductData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).put<
      UpdateProductResponse,
      UpdateProductError,
      ThrowOnError
    >({
      ...options,
      url: "/products/{id}",
    });
  };

  /**
   * Get Payment History
   * Get the combined payment history for a user across all payment services.
   */
  const getPaymentHistory = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetPaymentHistoryData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetPaymentHistoryResponse,
      GetPaymentHistoryError,
      ThrowOnError
    >({
      ...options,
      url: "/payments/history",
    });
  };

  /**
   * Get Subscriptions
   * Get all subscriptions for a user. Subscriptions are the products a user has subscribed to. Returns both active and inactive subscriptions.
   */
  const getSubscriptions = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetSubscriptionsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetSubscriptionsResponse,
      GetSubscriptionsError,
      ThrowOnError
    >({
      ...options,
      url: "/payments/subscriptions",
    });
  };

  /**
   * Get Payments By Invoice
   * Get all payments by invoice ID. Usually is just one payment, but can be multiple in case of partial payments.
   */
  const getPaymentsByInvoice = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetPaymentsByInvoiceData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetPaymentsByInvoiceResponse,
      GetPaymentsByInvoiceError,
      ThrowOnError
    >({
      ...options,
      url: "/payments/by-invoice/{id}",
    });
  };

  /**
   * Get Coupon By Code Captcha Auth
   * Get a coupon by code using captcha authentication
   */
  const getCouponByCodeCaptchaAuth = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetCouponByCodeCaptchaAuthData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetCouponByCodeCaptchaAuthResponse,
      GetCouponByCodeCaptchaAuthError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons/by-code/captcha",
    });
  };

  /**
   * Get Coupon By Code
   * Get a coupon by code. Only bearer auth is supported.
   */
  const getCouponByCode = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetCouponByCodeData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetCouponByCodeResponse,
      GetCouponByCodeError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons/by-code",
    });
  };

  /**
   * Get Coupons
   * List all coupons. Only bearer auth is supported.
   */
  const getCoupons = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetCouponsData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetCouponsResponse,
      GetCouponsError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons",
    });
  };

  /**
   * Create Coupon
   * Create a new coupon
   */
  const createCoupon = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateCouponData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateCouponResponse,
      CreateCouponError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons",
    });
  };

  /**
   * Update Coupon
   * Update a coupon
   */
  const updateCoupon = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<UpdateCouponData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).put<
      UpdateCouponResponse,
      UpdateCouponError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons/{id}",
    });
  };

  /**
   * Deactivate Coupon
   * Deactivate a coupon
   */
  const deactivateCoupon = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<DeactivateCouponData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).delete<
      DeactivateCouponResponse,
      DeactivateCouponError,
      ThrowOnError
    >({
      ...options,
      url: "/coupons/{id}",
    });
  };

  /**
   * Get Status
   * Get the status of the NOWPayments API
   */
  const getNowApiStatus = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetNowApiStatusResponse,
      GetNowApiStatusError,
      ThrowOnError
    >({
      ...options,
      url: "/now/status",
    });
  };

  /**
   * Handle Webhook
   * Handle NOWPayments webhook notifications (IPN).
   * Validates the signature, updates the payment status and creates a product subscription if the payment is successful.
   */
  const handleNowWebhook = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      HandleNowWebhookResponse,
      HandleNowWebhookError,
      ThrowOnError
    >({
      ...options,
      url: "/now/webhook",
    });
  };

  /**
   * Create Invoice
   * Create a payment invoice with a payment link for customer completion. Only Bearer authentication is supported.
   */
  const createInvoice = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<CreateInvoiceData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      CreateInvoiceResponse,
      CreateInvoiceError,
      ThrowOnError
    >({
      ...options,
      url: "/invoices",
    });
  };

  /**
   * Get Invoice
   * Get a payment invoice with a payment link for customer completion.
   */
  const getInvoice = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetInvoiceData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetInvoiceResponse,
      GetInvoiceError,
      ThrowOnError
    >({
      ...options,
      url: "/invoices/{id}",
    });
  };

  /**
   * Stripe Webhook
   */
  const stripeWebhookStripeWebhookPost = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).post<
      StripeWebhookStripeWebhookPostResponse,
      StripeWebhookStripeWebhookPostError,
      ThrowOnError
    >({
      ...options,
      url: "/stripe/webhook",
    });
  };

  /**
   * Get Aic Price
   * Return the current price of 1 AIC token in USD.
   */
  const getAicPrice = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetAicPriceData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetAicPriceResponse,
      GetAicPriceError,
      ThrowOnError
    >({
      ...options,
      url: "/token/price",
    });
  };

  /**
   * Get Balances
   * Get user's AIC balance and staking information for each connected wallet.
   */
  const getBalances = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<GetBalancesData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetBalancesResponse,
      GetBalancesError,
      ThrowOnError
    >({
      ...options,
      url: "/access/balances",
    });
  };

  /**
   * Get Accessible Scopes
   * Core endpoint: Returns all access scopes a user has (currently or in the last 7 days), and detailed info for each access method.
   * - `scopes`: List of currently active scopes (user has access right now).
   * - `info`: List of all access records (active and recently expired), for allowlist, subscription, and balance-based access.
   */
  const getScopesInfo = <ThrowOnError extends boolean = false>(
    options: OptionsLegacyParser<GetScopesInfoData, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetScopesInfoResponse,
      GetScopesInfoError,
      ThrowOnError
    >({
      ...options,
      url: "/access/scopes/info",
    });
  };

  /**
   * Get Thresholds
   * Get the access thresholds for the scopes.
   */
  const getThresholds = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetThresholdsResponse,
      GetThresholdsError,
      ThrowOnError
    >({
      ...options,
      url: "/access/thresholds",
    });
  };

  /**
   * Ping
   * Returns 'OK' if the API is running.
   */
  const ping = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      PingResponse,
      PingError,
      ThrowOnError
    >({
      ...options,
      url: "/",
    });
  };

  /**
   * Metrics
   * Get Prometheus metrics for the application. Returns plain text.
   */
  const getMetrics = <ThrowOnError extends boolean = false>(
    options?: OptionsLegacyParser<unknown, ThrowOnError>,
  ) => {
    return (options?.client ?? client).get<
      GetMetricsResponse,
      GetMetricsError,
      ThrowOnError
    >({
      ...options,
      url: "/metrics",
    });
  };

  return {
    getProductsCaptchaAuth,
    getProducts,
    createProduct,
    getProductUsage,
    updateProduct,
    getPaymentHistory,
    getSubscriptions,
    getPaymentsByInvoice,
    getCouponByCodeCaptchaAuth,
    getCouponByCode,
    getCoupons,
    createCoupon,
    updateCoupon,
    deactivateCoupon,
    getNowApiStatus,
    handleNowWebhook,
    createInvoice,
    getInvoice,
    stripeWebhookStripeWebhookPost,
    getAicPrice,
    getBalances,
    getScopesInfo,
    getThresholds,
    ping,
    getMetrics,
  };
}
